SELECT DISTINCT E4.ID
FROM ESTUDANTE E1
JOIN AMIZADE A1 ON E1.ID=A1.ID1
JOIN ESTUDANTE E2 ON A1.ID2=E2.ID
JOIN AMIZADE A2 ON A2.ID1=E2.ID
JOIN ESTUDANTE E3 ON E3.ID=A2.ID2
JOIN AMIZADE A3 ON A3.ID1=E3.ID
JOIN ESTUDANTE E4 ON A3.ID2=E4.ID
WHERE E1.NAME='Miguel Sampaio';